<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>שירות תמלול אודיו MP3 | המרת קול לטקסט מדויק</title>
    <meta name="description" content="המר קבצי MP3 לטקסט בעברית בקלות. שירות תמלול אודיו מהיר ומדויק.">
    
    <!-- קבצי CSS המפוצלים במקום קובץ components.css -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/buttons.css">
    <link rel="stylesheet" href="css/forms.css">
    <link rel="stylesheet" href="css/api-settings.css">
    <link rel="stylesheet" href="css/upload.css">
    <link rel="stylesheet" href="css/progress.css">
    <link rel="stylesheet" href="css/tabs-nav.css">
    <link rel="stylesheet" href="css/results.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="stylesheet" href="css/badges.css">
    <link rel="stylesheet" href="css/utilities.css">
    
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&family=Rubik:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="icon" type="image/png" href="icon.png" />

    <script src="https://cdn.jsdelivr.net/npm/lamejs@1.2.0/lame.min.js"></script>

    <!-- סגנונות נוספים עבור הפיצ'רים החדשים -->
    <style>
        /* סגנונות לאזור ההגהה והסיכום */
        .result-tabs {
            display: flex;
            margin-bottom: 1rem;
            border-bottom: 2px solid #e9ecef;
            background: #f8f9fa;
            border-radius: 8px 8px 0 0;
        }

        .result-tab-btn {
            flex: 1;
            padding: 12px 16px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            border-radius: 8px 8px 0 0;
            transition: all 0.3s ease;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .result-tab-btn:hover {
            background: #e9ecef;
            color: #495057;
        }

        .result-tab-btn.active {
            background: #007bff;
            color: white;
            font-weight: 600;
        }

        .result-tab-content {
            display: none;
        }

        .result-tab-content.active {
            display: block;
        }

        /* סגנונות לאזור פעולות הגהה/סיכום */
        .enhancement-controls, .summary-controls {
            margin-bottom: 1rem;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .summary-length-options {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .summary-length-options label {
            font-weight: 500;
            color: #495057;
        }

        .summary-length-options select {
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        .custom-prompt-container {
            width: 100%;
            margin-top: 10px;
        }

        .custom-prompt-container textarea {
            width: 100%;
            min-height: 80px;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-family: inherit;
            font-size: 14px;
            resize: vertical;
            line-height: 1.5;
        }

        /* תיבות התוצאות */
        #enhanced-result, #summary-result {
            width: 100%;
            min-height: 300px;
            padding: 15px;
            border: 1px solid #ced4da;
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            line-height: 1.6;
            background: white;
            overflow-y: auto;
        }

        /* עיצוב תוכן מפורמט */
        .section-title {
            color: #007bff;
            font-size: 18px;
            font-weight: 600;
            margin: 20px 0 10px 0;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }

        .main-title {
            color: #343a40;
            font-size: 20px;
            font-weight: 700;
            margin: 25px 0 15px 0;
        }

        .highlight {
            background: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
        }

        .bullet-item {
            margin: 8px 0;
            padding-right: 20px;
            position: relative;
        }

        .bullet-item::before {
            content: "•";
            color: #007bff;
            font-weight: bold;
            position: absolute;
            right: 0;
        }

        .section-divider {
            margin: 20px 0;
            border: none;
            height: 2px;
            background: linear-gradient(to left, #007bff, #6c757d);
        }

        /* הודעות עיבוד */
        .processing-message {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
            font-size: 16px;
        }

        .processing-message i {
            display: block;
            font-size: 24px;
            margin-bottom: 10px;
            color: #007bff;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #f5c6cb;
            text-align: center;
        }

        /* סגנונות לבחירת ספק AI */
        .provider-select {
            margin-bottom: 15px;
        }

        .provider-select label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #495057;
        }

        .provider-select select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        /* הגדרות API מורחבות */
        .api-section.optional .provider-options {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e9ecef;
        }

        /* סגנונות YouTube */
        .youtube-video-info {
            display: flex;
            gap: 15px;
            padding: 15px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            background: #f8f9fa;
            margin-top: 15px;
        }

        .video-thumbnail img {
            width: 120px;
            height: 90px;
            object-fit: cover;
            border-radius: 6px;
        }

        .video-details h4 {
            margin: 0 0 5px 0;
            color: #343a40;
            font-size: 16px;
        }

        .video-details p {
            margin: 0;
            color: #6c757d;
            font-size: 14px;
        }

        /* הקלטה */
        .record-wave-canvas {
            width: 100%;
            height: 70px;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            background: #f8f9fa;
        }

        /* אנימציות */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1><i class="upload-icon fas fa-cloud-upload-alt"></i> תמלול קבצי אודיו בעברית</h1>
            <p class="subtitle">העלה קובץ MP3 ותוך רגעים בודדים תקבל תמלול מדויק בעברית או בשפות נוספות</p>
        </header>

        <div class="card">
            <div id="api-settings" class="api-settings">
                <details>
                    <summary> הגדרות API <i class="fas fa-cog"></i></summary>
                    <div id="api-settings" class="api-settings">
                        <div class="api-section" style="margin-bottom: 2rem;">
                            <h4>מצב תמלול:</h4>
                            <label for="transcription-mode">בחר כיצד יבוצע התמלול:</label>
                            <span class="tooltip-icon">
                                <i class="fas fa-info-circle"></i>
                                <span class="tooltip-text">
                                    <strong>OpenAI בלבד:</strong> תמלול מדויק עם Whisper API<br>
                                    <strong>Hugging Face:</strong> תמלול חלופי עם מודלים בחינם
                                </span>
                            </span>
                            <select id="transcription-mode" class="styled-select">
                                <option value="openai-only" selected>OpenAI Whisper – תמלול מדויק</option>
                                <option value="huggingface">Hugging Face – תמלול חינמי</option>
                            </select>
                        </div>
                        
                        <div class="api-settings-content">
                            <!-- חלק חובה - OpenAI -->
                            <div class="api-section required">
                                <h4>OpenAI Whisper – תמלול מדויק : <span class="recommended-badge">מומלץ</span></h4>
                                <label for="openai-api-key">מפתח API של OpenAI</label>
                                <p class="api-description">נדרש לתמלול באיכות גבוהה עם Whisper API. ניתן לקבל מפתח באתר <a href="https://platform.openai.com" target="_blank">platform.openai.com</a></p>
                                <div class="api-input-group">
                                    <input type="password" id="openai-api-key" placeholder="הדבק את מפתח ה-API של OpenAI כאן">
                                    <button id="save-openai-key" class="btn"><i class="fas fa-save"></i> שמור</button>
                                </div>
                                <div style="margin-top: 10px;">
                                    <input type="checkbox" id="show-openai-key" style="margin-left: 8px;">
                                    <label for="show-openai-key">הצג/הסתר מפתח API</label>
                                </div>
                                <div id="openai-key-status" class="api-key-status"></div>
                                <div class="api-help-icon" id="openai-help-icon">
                                    <i class="fas fa-question-circle"></i>
                                </div>
                            </div>

                            <!-- חלק אופציונלי - Groq להגהה וסיכום -->
                            <div class="api-section optional">
                                <h4>Groq – הגהה וסיכום חכמים : <span class="recommended-badge">אופציונלי</span></h4>
                                <label for="groq-api-key">מפתח API של Groq</label>
                                <p class="api-description">אם ברצונך להשתמש בפיצ'רים של סיכום והגהה חכמה מבוססי AI, יש להזין כאן את מפתח ה־API של Groq. ניתן לקבל מפתח באתר <a href="https://groq.com" target="_blank">groq.com</a></p>
                                <div class="api-input-group">
                                    <input type="password" id="groq-api-key" placeholder="הדבק את מפתח ה-API של Groq כאן">
                                    <button id="save-groq-key" class="btn"><i class="fas fa-save"></i> שמור</button>
                                </div>
                                <div style="margin-top: 10px;">
                                    <input type="checkbox" id="show-groq-key" style="margin-left: 8px;">
                                    <label for="show-groq-key">הצג/הסתר מפתח API</label>
                                </div>
                                <div id="groq-key-status" class="api-key-status"></div>
                                <div class="api-help-icon" id="groq-help-icon">
                                    <i class="fas fa-question-circle"></i>
                                </div>
                            </div>

                            <!-- Anthropic -->
                            <div class="api-section optional">
                                <h4>Anthropic Claude – הגהה וסיכום מתקדמים : <span class="recommended-badge">אופציונלי</span></h4>
                                <label for="anthropic-api-key">מפתח API של Anthropic</label>
                                <p class="api-description">עבור הגהה וסיכום באיכות גבוהה עם Claude. ניתן לקבל מפתח באתר <a href="https://console.anthropic.com" target="_blank">console.anthropic.com</a></p>
                                <div class="api-input-group">
                                    <input type="password" id="anthropic-api-key" placeholder="הדבק את מפתח ה-API של Anthropic כאן">
                                    <button id="save-anthropic-key" class="btn"><i class="fas fa-save"></i> שמור</button>
                                </div>
                                <div style="margin-top: 10px;">
                                    <input type="checkbox" id="show-anthropic-key" style="margin-left: 8px;">
                                    <label for="show-anthropic-key">הצג/הסתר מפתח API</label>
                                </div>
                                <div id="anthropic-key-status" class="api-key-status"></div>
                                <div class="api-help-icon" id="anthropic-help-icon">
                                    <i class="fas fa-question-circle"></i>
                                </div>
                            </div>

                            <!-- חלק חובה - Huggingface -->
                            <div class="api-section required">
                                <h4>תמלול פחות חשוף לשגיאות</h4>
                                <label for="huggingface-api-key">מפתח API של Hugging Face</label>
                                <p class="api-description">נדרש כדי לתמלל קבצי אודיו לטקסט. ניתן לקבל מפתח באתר <a href="https://huggingface.co" target="_blank">huggingface.co</a></p>
                                <div class="api-input-group">
                                    <input type="password" id="huggingface-api-key" placeholder="הדבק את מפתח ה-API של Huggingface כאן">
                                    <button id="save-huggingface-key" class="btn"><i class="fas fa-save"></i> שמור</button>
                                </div>
                                <div style="margin-top: 10px;">
                                    <input type="checkbox" id="show-huggingface-key" style="margin-left: 8px;">
                                    <label for="show-huggingface-key">הצג/הסתר מפתח API</label>
                                </div>
                                <div id="huggingface-key-status" class="api-key-status"></div>
                                <div class="api-help-icon" id="huggingface-help-icon">
                                    <i class="fas fa-question-circle"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </details>
            </div>

            <!-- לשוניות אפשרויות העלאה -->
            <div class="upload-tabs">
                <div class="tabs-header">
                    <button class="tab-btn active" data-tab="upload-file">
                        <i class="fas fa-file-audio"></i> העלאת קובץ
                    </button>
                    <button class="tab-btn" data-tab="youtube-link">
                        <i class="fab fa-youtube"></i> סרטון יוטיוב
                    </button>
                    <button class="tab-btn" data-tab="record-audio">
                        <i class="fas fa-microphone"></i> הקלטה ישירה
                    </button>
                </div>

                <div class="tabs-content">
                    <!-- תוכן לשונית העלאת קובץ -->
                    <div class="tab-content active" id="upload-file-content">
                        <div id="upload-container">
                            <div id="upload-area" class="upload-area">
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h3>גרור לכאן קובץ אודיו MP3</h3>
                                <p>או לחץ כדי לבחור קובץ</p>
                                <input type="file" id="file-input" accept="audio/*,.mp3,.wav,.webm,.ogg,.m4a" style="display: none;">
                                <button class="btn" id="select-file-btn"><i class="fas fa-file-audio"></i> בחר קובץ MP3</button>
                            </div>

                            <div id="file-info" class="file-info">
                                <p><i class="fas fa-file-audio"></i> הקובץ שנבחר: <span id="file-name" class="file-name"></span></p>
                                <p id="file-size"></p>
                                <div class="settings">
                                    <div class="checkbox-wrapper" style="display: none;">
                                        <input type="checkbox" id="split-audio" checked>
                                        <label for="split-audio">פיצול לקטעים קצרים</label>
                                        <span class="checkmark"></span>
                                    </div>

                                    <details class="split-settings-details">
                                        <summary>הגדרות פיצול מתקדמות <i class="fas fa-cog"></i></summary>
                                        <div class="split-settings">
                                            <label for="segment-length">אורך כל קטע בשניות:</label>
                                            <input type="number" id="segment-length" value="25" min="5" max="30">
                                            <span class="badge badge-secondary">מומלץ: 25 שניות</span>
                                            <p class="note"><i class="fas fa-info-circle"></i> הערה: מומלץ לקבוע ערך נמוך מ-30 שניות לתוצאות מדויקות יותר</p>
                                        </div>
                                    </details>
                                </div>
                                <div id="estimated-time-container" class="estimated-time-box">
                                    <i class="fas fa-clock"></i>
                                    <span class="estimated-label">זמן משוער לתמלול:</span>
                                    <span id="time-estimate">—</span>
                                </div>

                                <div class="button-group">
                                    <button class="btn" id="transcribe-btn"><i class="fas fa-magic"></i> התחל תמלול MP3</button>
                                    <a href="#" id="download-source-btn" class="btn download-btn">
                                        <i class="fas fa-download"></i> הורד את קובץ האודיו
                                    </a>
                                </div>
                            </div>

                            <div id="progress-container" class="progress-container">
                                <h4 id="progress-status">מעבד את קובץ האודיו...</h4>
                                <div id="progress-bar-container" class="progress-bar-container">
                                    <div id="progress-bar" class="progress-bar"></div>
                                </div>
                                <p id="progress-text" class="progress-text">0%</p>
                                <div class="loading-spinner"></div>
                                <p class="note">תהליך התמלול עשוי להימשך מספר דקות בהתאם לאורך הקובץ</p>
                            </div>

                            <div id="loading-spinner" class="loading-spinner"></div>
                            <div id="error-message" class="error-message"></div>
                        </div>
                    </div>

                    <!-- תוכן לשונית יוטיוב -->
                    <div class="tab-content" id="youtube-link-content">
                        <div class="youtube-input-area">
                            <h3>הזן קישור לסרטון יוטיוב</h3>
                            <p>המערכת תמללה את השמע מהסרטון</p>

                            <div class="youtube-input-group">
                                <input type="text" id="youtube-url" placeholder="הדבק כאן קישור YouTube" />
                                <button class="btn" id="process-youtube-btn">
                                    <i class="fas fa-magic"></i> תמלל סרטון
                                </button>
                            </div>
                            
                            <div class="youtube-info" style="display: none;"></div>

                            <div id="youtube-loading" style="display: none; margin-top: 1rem; text-align: center;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 18px; color: #007bff; margin-left: 6px;"></i>
                                <span style="font-size: 15px; color: #333;">התהליך עשוי להימשך מספר רגעים...</span>
                            </div>

                            <p class="note"><i class="fas fa-info-circle"></i> הערה: יש להשתמש בקישור ישיר לסרטון YouTube</p>
                        </div>
                    </div>

                    <!-- תוכן לשונית הקלטה ישירה -->
                    <div class="tab-content" id="record-audio-content">
                        <div class="record-area">
                            <h3>הקלט אודיו ישירות</h3>
                            <p>לחץ על הכפתור כדי להתחיל בהקלטה</p>
                            <div class="record-buttons">
                                <button class="btn btn-record" id="start-record-btn">
                                    <i class="fas fa-microphone"></i> התחל הקלטה
                                </button>
                                <button class="btn btn-stop" id="stop-record-btn" disabled>
                                    <i class="fas fa-stop-circle"></i> עצור הקלטה
                                </button>
                            </div>
                            <div class="record-status">
                                <div id="record-timer">00:00</div>
                                <div id="record-wave" class="record-wave">
                                    <canvas id="waveform" width="800" height="200" class="record-wave-canvas"></canvas>
                                </div>
                            </div>
                            <p class="note"><i class="fas fa-info-circle"></i> לאחר סיום ההקלטה תוכל לתמלל את האודיו</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- אזור התוצאות המעודכן עם טאבים -->
            <div id="result-container" class="result-container">
                <h3 class="decorated">תוצאת התמלול <span class="badge badge-success">הושלם!</span></h3>

                <!-- לשוניות תוצאה עם הגהה וסיכום AI -->
                <div class="result-tabs">
                    <button class="result-tab-btn active" data-result-tab="original">
                        <i class="fas fa-file-text"></i> תמלול מקורי
                    </button>
                    <button class="result-tab-btn" data-result-tab="enhanced">
                        <i class="fas fa-magic"></i> הגהה חכמה
                    </button>
                    <button class="result-tab-btn" data-result-tab="summary">
                        <i class="fas fa-brain"></i> סיכום AI
                    </button>
                </div>

                <!-- תוכן לשוניות התוצאה -->
                <div class="result-tabs-content">
                    <!-- תמלול מקורי -->
                    <div class="result-tab-content active" id="original-content">
                        <textarea id="transcription-result" readonly></textarea>
                    </div>

                    <!-- הגהה חכמה -->
                    <div class="result-tab-content" id="enhanced-content">
                        <div class="enhancement-controls">
                            <!-- בחירת ספק AI להגהה -->
                            <div class="provider-select">
                                <label for="enhance-provider-select">ספק AI להגהה:</label>
                                <select id="enhance-provider-select">
                                    <option value="openai">OpenAI GPT</option>
                                    <option value="groq" selected>Groq Llama</option>
                                    <option value="anthropic">Anthropic Claude</option>
                                </select>
                            </div>

                            <!-- שדה API Key דינמי להגהה -->
                            <div id="enhance-api-input" class="api-input-section" style="display: none;">
                                <label id="enhance-api-label">מפתח API:</label>
                                <div class="api-input-group">
                                    <input type="password" id="enhance-api-key" placeholder="הזן מפתח API">
                                    <button id="save-enhance-api" class="btn btn-sm">
                                        <i class="fas fa-save"></i> שמור
                                    </button>
                                </div>
                                <div id="enhance-api-status" class="api-status-mini"></div>
                            </div>

                            <!-- אפשרויות הגהה -->
                            <div class="summary-length-options">
                                <label for="enhance-mode">בחר סוג הגהה:</label>
                                <select id="enhance-mode">
                                    <option value="default" selected>הגהת ברירת מחדל</option>
                                    <option value="custom">פרומפט חופשי</option>
                                </select>

                                <button id="generate-enhancement-btn" class="btn btn-primary">
                                    <i class="fas fa-pen-to-square"></i> בצע הגהה
                                </button>
                            </div>

                            <!-- פרומפט מותאם אישית להגהה -->
                            <div id="enhance-custom-prompt-container" class="custom-prompt-container" style="display: none;">
                                <textarea id="enhance-custom-prompt" placeholder="כתוב כאן הוראות מותאמות אישית להגהה..." rows="3"></textarea>
                            </div>
                        </div>

                        <div id="enhanced-result" style="min-height: 300px; padding: 15px; border: 1px solid #ced4da; border-radius: 8px; background: white; overflow-y: auto;">
                            <div class="processing-message">
                                <i class="fas fa-magic"></i>
                                לחץ על "בצע הגהה" כדי לשפר את הטקסט באמצעות AI
                            </div>
                        </div>
                    </div>

                    <!-- סיכום AI -->
                    <div class="result-tab-content" id="summary-content">
                        <div class="summary-controls">
                            <!-- בחירת ספק AI לסיכום -->
                            <div class="provider-select">
                                <label for="summary-provider-select">ספק AI לסיכום:</label>
                                <select id="summary-provider-select">
                                    <option value="openai">OpenAI GPT</option>
                                    <option value="groq" selected>Groq Llama</option>
                                    <option value="anthropic">Anthropic Claude</option>
                                </select>
                            </div>

                            <!-- שדה API Key דינמי לסיכום -->
                            <div id="summary-api-input" class="api-input-section" style="display: none;">
                                <label id="summary-api-label">מפתח API:</label>
                                <div class="api-input-group">
                                    <input type="password" id="summary-api-key" placeholder="הזן מפתח API">
                                    <button id="save-summary-api" class="btn btn-sm">
                                        <i class="fas fa-save"></i> שמור
                                    </button>
                                </div>
                                <div id="summary-api-status" class="api-status-mini"></div>
                            </div>

                            <!-- אפשרויות סיכום -->
                            <div class="summary-length-options">
                                <label for="summary-length">בחר אורך סיכום:</label>
                                <select id="summary-length">
                                    <option value="short">קצר</option>
                                    <option value="medium" selected>בינוני</option>
                                    <option value="long">ארוך</option>
                                    <option value="custom">פרומפט חופשי</option>
                                </select>

                                <button id="generate-summary-btn" class="btn btn-primary">
                                    <i class="fas fa-brain"></i> צור סיכום
                                </button>
                            </div>

                            <!-- פרומפט מותאם אישית לסיכום -->
                            <div id="custom-prompt-container" class="custom-prompt-container" style="display: none;">
                                <textarea id="custom-prompt" placeholder="הקלד הוראות מותאמות אישית לסיכום..." rows="3"></textarea>
                            </div>
                        </div>

                        <div id="summary-result" style="min-height: 300px; padding: 15px; border: 1px solid #ced4da; border-radius: 8px; background: white; overflow-y: auto;">
                            <div class="processing-message">
                                <i class="fas fa-brain"></i>
                                לחץ על "צור סיכום" כדי לקבל סיכום חכם של הטקסט
                            </div>
                        </div>
                    </div>
                </div>

                <!-- כפתורי פעולה -->
                <div class="actions">
                    <div class="action-group">
                        <button class="btn new-btn" id="new-btn"><i class="fas fa-plus"></i> תמלול חדש</button>
                    </div>

                    <div class="action-group">
                        <button class="btn copy-btn small-btn" id="copy-btn"><i class="fas fa-copy"></i> העתק</button>

                        <div class="dropdown">
                            <button class="btn download-btn dropdown-toggle" id="download-dropdown-btn">
                                <i class="fas fa-download"></i> הורד כ-
                            </button>
                            <div class="dropdown-menu" id="download-options">
                                <button class="dropdown-item" data-format="txt"><i class="fas fa-file-alt"></i> קובץ טקסט (TXT)</button>
                                <button class="dropdown-item" data-format="srt"><i class="fas fa-closed-captioning"></i> כתוביות (SRT)</button>
                                <button class="dropdown-item" data-format="word"><i class="fas fa-file-word"></i> מסמך Word</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="floating-card" style="display: none;" id="tips-card">
                <h4><i class="fas fa-lightbulb"></i> טיפים לתמלול מוצלח</h4>
                <ul>
                    <li>וודא שהקובץ באיכות טובה עם רעש רקע מינימלי</li>
                    <li>עבור קבצים ארוכים, הפיצול לקטעים קצרים משפר את איכות התמלול</li>
                    <li>מומלץ לבדוק את התמלול ולתקן שגיאות במידת הצורך</li>
                    <li>השתמש בהגהה החכמה לשיפור הטקסט</li>
                    <li>צור סיכום AI לקבלת הנקודות העיקריות</li>
                </ul>
            </div>
        </div>

        <!-- מודלים להדרכה -->
        
        <!-- מודל OpenAI -->
        <div id="openai-guide-modal" class="modal">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h3>איך להשיג מפתח API של OpenAI</h3>
                <div class="guide-steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>היכנס לאתר OpenAI</h4>
                            <p>פתח את האתר <a href="https://platform.openai.com/" target="_blank">platform.openai.com</a></p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>צור חשבון או התחבר</h4>
                            <p>לחץ על "Sign Up" בפינה הימנית העליונה ליצירת חשבון חדש, או התחבר לחשבון קיים</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>נווט לאזור API Keys</h4>
                            <p>לאחר ההתחברות, לחץ על "API Keys" בתפריט הצדדי השמאלי</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>צור מפתח API חדש</h4>
                            <p>לחץ על כפתור "Create new secret key", תן שם למפתח ולחץ על "Create secret key"</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <h4>העתק את המפתח</h4>
                            <p>העתק את המפתח שנוצר והדבק אותו בשדה "מפתח API של OpenAI" בעמוד זה</p>
                        </div>
                    </div>
                </div>
                <div class="guide-note">
                    <p><strong>שים לב:</strong> מפתח ה-API נשמר רק על המכשיר שלך באופן מקומי ואינו נשלח לשום שרת אחר מלבד OpenAI.</p>
                </div>
            </div>
        </div>

        <!-- מודל Huggingface -->
        <div id="huggingface-guide-modal" class="modal">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h3>איך להשיג מפתח API של Huggingface</h3>
                <div class="guide-steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>היכנס לאתר Huggingface</h4>
                            <p>פתח את האתר <a href="https://huggingface.co/" target="_blank">huggingface.co</a></p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>צור חשבון או התחבר</h4>
                            <p>לחץ על "Sign Up" בפינה הימנית העליונה ליצירת חשבון חדש, או התחבר לחשבון קיים</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>פתח את הגדרות המשתמש</h4>
                            <p>לאחר ההתחברות, לחץ על תמונת הפרופיל שלך בפינה הימנית העליונה ובחר ב-"Settings"</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>צור מפתח API חדש</h4>
                            <p>בתפריט הצדדי, בחר ב-"Access Tokens", ואז לחץ על כפתור "New token"</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <h4>הגדר את המפתח</h4>
                            <p>תן שם למפתח (לדוגמה "Audio Transcription"), בחר הרשאות "Read" ולחץ על "Generate token"</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">6</div>
                        <div class="step-content">
                            <h4>העתק את המפתח</h4>
                            <p>העתק את המפתח שנוצר והדבק אותו בשדה "מפתח API של Huggingface" בעמוד זה</p>
                        </div>
                    </div>
                </div>
                <div class="guide-note">
                    <p><strong>שים לב:</strong> מפתח ה-API נשמר רק על המכשיר שלך באופן מקומי ואינו נשלח לשום שרת אחר מלבד Huggingface.</p>
                </div>
            </div>
        </div>

        <!-- מודל Groq -->
        <div id="groq-guide-modal" class="modal">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h3>איך להשיג מפתח API של Groq</h3>
                <div class="guide-steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>היכנס לאתר Groq</h4>
                            <p>פתח את האתר <a href="https://console.groq.com/" target="_blank">console.groq.com</a></p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>צור חשבון או התחבר</h4>
                            <p>לחץ על "Sign Up" ליצירת חשבון חדש, או התחבר לחשבון קיים</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>נווט לאזור API Keys</h4>
                            <p>לאחר ההתחברות, נווט לאזור API Keys בממשק המשתמש</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>צור מפתח API חדש</h4>
                            <p>לחץ על כפתור "Create API Key" ליצירת מפתח חדש</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <h4>העתק את המפתח</h4>
                            <p>העתק את המפתח שנוצר והדבק אותו בשדה "מפתח API של Groq" בעמוד זה</p>
                        </div>
                    </div>
                </div>
                <div class="guide-note">
                    <p><strong>שים לב:</strong> מפתח ה-API נשמר רק על המכשיר שלך באופן מקומי ואינו נשלח לשום שרת אחר מלבד Groq.</p>
                </div>
            </div>
        </div>

        <!-- מודל Anthropic -->
        <div id="anthropic-guide-modal" class="modal">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h3>איך להשיג מפתח API של Anthropic</h3>
                <div class="guide-steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>היכנס לאתר Anthropic</h4>
                            <p>פתח את האתר <a href="https://console.anthropic.com/" target="_blank">console.anthropic.com</a></p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>צור חשבון או התחבר</h4>
                            <p>לחץ על "Sign Up" ליצירת חשבון חדש, או התחבר לחשבון קיים</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>נווט לאזור API Keys</h4>
                            <p>לאחר ההתחברות, נווט לאזור API Keys בממשק המשתמש</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>צור מפתח API חדש</h4>
                            <p>לחץ על כפתור "Create Key" ליצירת מפתח חדש</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <h4>העתק את המפתח</h4>
                            <p>העתק את המפתח שנוצר והדבק אותו בשדה "מפתח API של Anthropic" בעמוד זה</p>
                        </div>
                    </div>
                </div>
                <div class="guide-note">
                    <p><strong>שים לב:</strong> מפתח ה-API נשמר רק על המכשיר שלך באופן מקומי ואינו נשלח לשום שרת אחר מלבד Anthropic.</p>
                </div>
            </div>
        </div>

        <!-- כפתור עזרה צף -->
        <button id="help-btn" title="עזרה">i</button>

        <!-- תיבת עזרה -->
        <div id="help-popup">
            <h2>מדריך שימוש מהיר</h2>

            <div class="help-step">
                <h3>
                    <span class="step-number">1</span>
                    הכנסת מפתח API ✔️
                </h3>
                <p>כדי שהתמלול יעבוד, עליך להזין מפתח API של OpenAI או Hugging Face.</p>
                <div class="help-links">
                    <a href="https://platform.openai.com/api-keys" target="_blank">
                        <i class="fas fa-key"></i> קבל מפתח OpenAI
                    </a>
                    <a href="https://huggingface.co/settings/tokens" target="_blank">
                        <i class="fas fa-key"></i> קבל מפתח Hugging Face
                    </a>
                </div>
                <button id="scroll-to-api" class="inline-btn">
                    <i class="fas fa-cog"></i> להסבר נרחב - עבור להגדרות API
                </button>
            </div>
            
            <div class="help-step">
                <h3>
                    <span class="step-number">2</span>
                    העלאת קובץ אודיו ✔️
                </h3>
                <p>העלה קובץ MP3, WAV או פורמטי אודיו נוספים.</p>
                <div class="help-links">
                    <a href="https://cloudconvert.com/audio-converter" target="_blank">
                        <i class="fas fa-exchange-alt"></i> המר קבצי אודיו אחרים
                    </a>
                </div>
            </div>

            <div class="help-step">
                <h3>
                    <span class="step-number">3</span>
                    התחלת תמלול ✔️
                </h3>
                <p>לחץ על "התחל תמלול" ותקבל טקסט מדויק.</p>
            </div>

            <div class="help-step">
                <h3>
                    <span class="step-number">4</span>
                    שיפור בעזרת AI ✨
                </h3>
                <p>השתמש בהגהה חכמה וסיכום AI לשיפור התוצאות.</p>
            </div>

            <div class="developer-toggle">
                <details>
                    <summary>על יוצר האתר <span class="profile-emoji">👨‍💻</span></summary>
                    <h4>ידידיה שאולי - מתכנת חובב</h4>
                    אני ידידיה שאולי, מפתח האתר הזה.

                    הקמתי אותו כדי להנגיש תמלול קולי איכותי במיוחד לדוברי עברית, בצורה פשוטה, חינמית וללא צורך בהרשמה.
                    עכשיו עם יכולות AI מתקדמות להגהה וסיכום!
                    
                    אשמח לפידבק והצעות לשיפור!

                    <div class="developer-links">
                        <a href="https://github.com/yedi18" target="_blank">
                            <i class="fab fa-github"></i> GitHub
                        </a>
                        <a href="https://www.linkedin.com/in/yedidya-shauli-6084a928a/" target="_blank">
                            <i class="fab fa-linkedin"></i> LinkedIn
                        </a>
                    </div>
                </details>
            </div>

            <button id="close-help-popup" class="close-btn">סגור</button>
        </div>

        <footer>
            <p>© 2025 שירות תמלול אודיו - פשוט, מהיר ומדויק עם יכולות AI מתקדמות. <a href="#" id="show-tips">טיפים לשימוש</a></p>
        </footer>

        <!-- נגדיר סקריפט קצר לבדיקת שגיאות -->
        <script>
            window.onerror = function (message, source, lineno, colno, error) {
                console.error('--- שגיאת JavaScript מלאה ---');
                console.error('הודעה:', message);
                console.error('קובץ:', source);
                console.error('שורה:', lineno, 'עמודה:', colno);
                console.error('אובייקט שגיאה:', error);
                if (error && error.stack) console.error('Stack:', error.stack);
                return false;
            };
        </script>

        <!-- טעינת קבצי JavaScript בסדר הנכון -->
        <script src="js/audioSplitter.js"></script>
        <script src="js/transcription.js"></script>
        <script src="js/enhancementHandler.js"></script>
        <script src="js/recordingHandler.js"></script>
        <script src="js/youtubeHandler.js"></script>
        
        <!-- מודולי ממשק משתמש -->
        <script src="js/js-ui/UICore.js"></script>
        <script src="js/js-ui/UIHandlers.js"></script>
        <script src="js/js-ui/UIFileOperations.js"></script>
        <script src="js/js-ui/UIAPIManagement.js"></script>
        <script src="js/js-ui/UIProgressDisplay.js"></script>
        <script src="js/js-ui/UIResultsDisplay.js"></script>
        <script src="js/js-ui/UI.js"></script>
        <script src="js/main.js"></script>

        <!-- סקריפטים לטיפול במודלים -->
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                // בדיקה אם כל המודולים נטענו כראוי
                if (typeof window.AudioSplitter === 'undefined') {
                    console.error('AudioSplitter לא נטען!');
                } else {
                    console.log('AudioSplitter נטען בהצלחה');
                }

                if (typeof window.Transcription === 'undefined') {
                    console.error('Transcription לא נטען!');
                } else {
                    console.log('Transcription נטען בהצלחה');
                }

                if (typeof window.UI === 'undefined') {
                    console.error('UI לא נטען!');
                } else {
                    console.log('UI נטען בהצלחה');
                }

                if (typeof window.EnhancementHandler === 'undefined') {
                    console.error('EnhancementHandler לא נטען!');
                } else {
                    console.log('EnhancementHandler נטען בהצלחה');
                }

                // הוספת פונקציונליות להצגת טיפים
                document.getElementById('show-tips').addEventListener('click', function (e) {
                    e.preventDefault();
                    const tipsCard = document.getElementById('tips-card');
                    tipsCard.style.display = tipsCard.style.display === 'none' ? 'block' : 'none';
                });
            });
        </script>

        <!-- סקריפטים לטיפול במודלי הדרכה -->
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                // מודאל Huggingface
                const hfHelpIcon = document.getElementById("huggingface-help-icon");
                const hfModal = document.getElementById("huggingface-guide-modal");
                const hfCloseModal = document.querySelector("#huggingface-guide-modal .close-modal");

                if (hfHelpIcon && hfModal && hfCloseModal) {
                    hfHelpIcon.addEventListener("click", () => {
                        hfModal.style.display = "block";
                    });

                    hfCloseModal.addEventListener("click", () => {
                        hfModal.style.display = "none";
                    });

                    window.addEventListener("click", (e) => {
                        if (e.target === hfModal) {
                            hfModal.style.display = "none";
                        }
                    });
                }

                // מודאל OpenAI
                const openaiHelpIcon = document.getElementById("openai-help-icon");
                const openaiModal = document.getElementById("openai-guide-modal");
                const openaiCloseModal = document.querySelector("#openai-guide-modal .close-modal");

                if (openaiHelpIcon && openaiModal && openaiCloseModal) {
                    openaiHelpIcon.addEventListener("click", () => {
                        openaiModal.style.display = "block";
                    });

                    openaiCloseModal.addEventListener("click", () => {
                        openaiModal.style.display = "none";
                    });

                    window.addEventListener("click", (e) => {
                        if (e.target === openaiModal) {
                            openaiModal.style.display = "none";
                        }
                    });
                }

                // מודאל Groq
                const groqHelpIcon = document.getElementById("groq-help-icon");
                const groqModal = document.getElementById("groq-guide-modal");
                const groqCloseModal = document.querySelector("#groq-guide-modal .close-modal");

                if (groqHelpIcon && groqModal && groqCloseModal) {
                    groqHelpIcon.addEventListener("click", () => {
                        groqModal.style.display = "block";
                    });

                    groqCloseModal.addEventListener("click", () => {
                        groqModal.style.display = "none";
                    });

                    window.addEventListener("click", (e) => {
                        if (e.target === groqModal) {
                            groqModal.style.display = "none";
                        }
                    });
                }

                // מודאל Anthropic
                const anthropicHelpIcon = document.getElementById("anthropic-help-icon");
                const anthropicModal = document.getElementById("anthropic-guide-modal");
                const anthropicCloseModal = document.querySelector("#anthropic-guide-modal .close-modal");

                if (anthropicHelpIcon && anthropicModal && anthropicCloseModal) {
                    anthropicHelpIcon.addEventListener("click", () => {
                        anthropicModal.style.display = "block";
                    });

                    anthropicCloseModal.addEventListener("click", () => {
                        anthropicModal.style.display = "none";
                    });

                    window.addEventListener("click", (e) => {
                        if (e.target === anthropicModal) {
                            anthropicModal.style.display = "none";
                        }
                    });
                }
            });
        </script>

        <!-- סקריפט לטיפול בתצוגה דינמית של API keys -->
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                // פונקציה להצגת/הסתרת שדה API key
                function toggleApiInput(selectElement, inputContainer, labelElement, inputElement, provider) {
                    const savedKey = localStorage.getItem(`${provider}_api_key`);
                    
                    if (!savedKey) {
                        inputContainer.style.display = 'block';
                        labelElement.textContent = `מפתח API של ${getProviderName(provider)}:`;
                        inputElement.placeholder = `הזן מפתח API של ${getProviderName(provider)}`;
                    } else {
                        inputContainer.style.display = 'none';
                        updateApiStatus(inputContainer.querySelector('.api-status-mini'), true, provider);
                    }
                }

                // פונקציה לקבלת שם הספק בעברית
                function getProviderName(provider) {
                    const names = {
                        openai: 'OpenAI',
                        groq: 'Groq',
                        anthropic: 'Anthropic Claude'
                    };
                    return names[provider] || provider;
                }

                // פונקציה לעדכון סטטוס API
                function updateApiStatus(statusElement, isSuccess, provider) {
                    if (!statusElement) return;
                    
                    statusElement.className = `api-status-mini ${isSuccess ? 'success' : 'error'}`;
                    statusElement.textContent = isSuccess 
                        ? `מפתח ${getProviderName(provider)} פעיל ✓`
                        : `נדרש מפתח ${getProviderName(provider)}`;
                }

                // טיפול בבחירת ספק להגהה
                const enhanceSelect = document.getElementById('enhance-provider-select');
                const enhanceApiInput = document.getElementById('enhance-api-input');
                const enhanceApiLabel = document.getElementById('enhance-api-label');
                const enhanceApiKey = document.getElementById('enhance-api-key');
                const saveEnhanceApi = document.getElementById('save-enhance-api');
                const enhanceApiStatus = document.getElementById('enhance-api-status');

                if (enhanceSelect && enhanceApiInput) {
                    enhanceSelect.addEventListener('change', function() {
                        toggleApiInput(this, enhanceApiInput, enhanceApiLabel, enhanceApiKey, this.value);
                    });

                    // בדיקה ראשונית
                    toggleApiInput(enhanceSelect, enhanceApiInput, enhanceApiLabel, enhanceApiKey, enhanceSelect.value);
                }

                // שמירת מפתח API להגהה
                if (saveEnhanceApi) {
                    saveEnhanceApi.addEventListener('click', function() {
                        const provider = enhanceSelect.value;
                        const apiKey = enhanceApiKey.value.trim();
                        
                        if (apiKey) {
                            localStorage.setItem(`${provider}_api_key`, apiKey);
                            updateApiStatus(enhanceApiStatus, true, provider);
                            enhanceApiInput.style.display = 'none';
                            
                            // הצגת הודעת הצלחה
                            const btn = this;
                            const originalText = btn.innerHTML;
                            btn.innerHTML = '<i class="fas fa-check"></i> נשמר!';
                            btn.style.background = '#28a745';
                            
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.style.background = '';
                            }, 2000);
                        } else {
                            updateApiStatus(enhanceApiStatus, false, provider);
                        }
                    });
                }

                // טיפול בבחירת ספק לסיכום
                const summarySelect = document.getElementById('summary-provider-select');
                const summaryApiInput = document.getElementById('summary-api-input');
                const summaryApiLabel = document.getElementById('summary-api-label');
                const summaryApiKey = document.getElementById('summary-api-key');
                const saveSummaryApi = document.getElementById('save-summary-api');
                const summaryApiStatus = document.getElementById('summary-api-status');

                if (summarySelect && summaryApiInput) {
                    summarySelect.addEventListener('change', function() {
                        toggleApiInput(this, summaryApiInput, summaryApiLabel, summaryApiKey, this.value);
                    });

                    // בדיקה ראשונית
                    toggleApiInput(summarySelect, summaryApiInput, summaryApiLabel, summaryApiKey, summarySelect.value);
                }

                // שמירת מפתח API לסיכום
                if (saveSummaryApi) {
                    saveSummaryApi.addEventListener('click', function() {
                        const provider = summarySelect.value;
                        const apiKey = summaryApiKey.value.trim();
                        
                        if (apiKey) {
                            localStorage.setItem(`${provider}_api_key`, apiKey);
                            updateApiStatus(summaryApiStatus, true, provider);
                            summaryApiInput.style.display = 'none';
                            
                            // הצגת הודעת הצלחה
                            const btn = this;
                            const originalText = btn.innerHTML;
                            btn.innerHTML = '<i class="fas fa-check"></i> נשמר!';
                            btn.style.background = '#28a745';
                            
                            setTimeout(() => {
                                btn.innerHTML = originalText;
                                btn.style.background = '';
                            }, 2000);
                        } else {
                            updateApiStatus(summaryApiStatus, false, provider);
                        }
                    });
                }

                // אפשרות ללחוץ Enter בשדה API key
                if (enhanceApiKey) {
                    enhanceApiKey.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            saveEnhanceApi.click();
                        }
                    });
                }

                if (summaryApiKey) {
                    summaryApiKey.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            saveSummaryApi.click();
                        }
                    });
                }
            });
        </script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                // OpenAI
                const showOpenaiKey = document.getElementById("show-openai-key");
                const openaiApiKey = document.getElementById("openai-api-key");
                
                if (showOpenaiKey && openaiApiKey) {
                    showOpenaiKey.addEventListener("change", function() {
                        openaiApiKey.type = this.checked ? "text" : "password";
                    });
                }

                // Groq
                const showGroqKey = document.getElementById("show-groq-key");
                const groqApiKey = document.getElementById("groq-api-key");
                
                if (showGroqKey && groqApiKey) {
                    showGroqKey.addEventListener("change", function() {
                        groqApiKey.type = this.checked ? "text" : "password";
                    });
                }

                // Anthropic
                const showAnthropicKey = document.getElementById("show-anthropic-key");
                const anthropicApiKey = document.getElementById("anthropic-api-key");
                
                if (showAnthropicKey && anthropicApiKey) {
                    showAnthropicKey.addEventListener("change", function() {
                        anthropicApiKey.type = this.checked ? "text" : "password";
                    });
                }

                // Huggingface
                const showHfKey = document.getElementById("show-huggingface-key");
                const hfApiKey = document.getElementById("huggingface-api-key");
                
                if (showHfKey && hfApiKey) {
                    showHfKey.addEventListener("change", function() {
                        hfApiKey.type = this.checked ? "text" : "password";
                    });
                }
            });
        </script>
    </div>
</body>

</html>